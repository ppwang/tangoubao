<form editable-form name="editableForm" onaftersave="saveDeal()" editModeOnNewDeal>
    <div>
        <span editable-text="deal.name" e-name="name" e-required>{{deal.name}}</span>
        <span ng-show="editableForm.$visible">* name of the deal</span>
    </div>
    <div>
        <span editable-text="deal.subtitle" e-name="subtitle" e-required>{{deal.subtitle}}</span>
        <span ng-show="editableForm.$visible">* subtitle of the deal</span>
    </div>
    <div>
        <span editable-textarea="deal.detailedDescription" e-rows="7" e-cols="40" class="editableTextArea">{{deal.detailedDescription}}</span>
        <span ng-show="editableForm.$visible" class="editablePropertyDescription">* description of the deal</span>
    </div>
    <div>
        <span>Begin Date: </span>
        <!-- TODO: when enter edit mode the first time, datetime is not properly formatted. -->
        <span editable-bsdate="deal.beginDate" e-datepicker-popup="MM-dd-yyyy">{{(deal.beginDate | date:"MM/dd/yyyy") || 'empty'}}</span>
        <br>
        <span>End Date:</span>
        <span editable-bsdate="deal.endDate" e-datepicker-popup="MM-dd-yyyy">{{(deal.endDate | date:"MM/dd/yyyy") || 'empty'}}</span>        
    </div>
    <div>
        <span
            class="clickableText"
            ng-show="editableForm.$visible"
            input-image
            append-data-uri
            resize
            resize-max-height="300"
            resize-max-width="250"
            resize-quality="1.0"
            ng-model="productImageUpload">
            Upload product image
        </span>
        <!-- TODO: clicking the clear button will trigger form validation -->
        <span class="clickableText" ng-show="editableForm.$visible" ng-click="clearproductImageUpload()">Clear image</span>
        <br>
        <img ng-show="editableForm.$visible && productImageUpload" src="{{productImageUpload.resized.dataURL}}"/>
        <!-- Because we cannot pre-populate the input file, we still show the image in the model if nothing is uploaded. -->
        <img ng-show="(!editableForm.$visible || !productImageUpload) && deal.imageBase64" src="{{deal.imageBase64 ? 'data:' + deal.imageType + ';base64,' + deal.imageBase64 : ''}}">
        <br>
    </div>
    <div>
        <span>Email: </span>
        <span editable-email="deal.email">{{ deal.email}}</span>
    </div>
    <div>
        <span>Tel: </span>
        <!-- TODO: allow phone numbers to be stored in pure numerical format. -->
        <span editable-tel="deal.phoneNumber" e-pattern="\d{3}\-\d{4}" e-title="xxx-xxxx">{{deal.phoneNumber}}</span>
    </div>
    <div>
        <span>Pickup options: </span>
        <ul>
            <li ng-repeat="option in deal.pickupOptions">
                <span editable-text="option.description" e-name="subtitle" e-required>{{option.description}}</span>
            </li>
        </ul>
    </div>
    <div>
        <span editable-textarea="deal.remarks" e-rows="7" e-cols="40" class="editableTextArea">{{deal.remarks}}</span>
        <span ng-show="editableForm.$visible" class="editablePropertyDescription">* additional remarks (e.g. other contact information)</span>
    </div>
    <div>
    </div>
    <div class="buttons" ng-show="deal.type === 'own'">
        <!-- button to show form -->
        <span ng-show="!editableForm.$visible">
            <button type="button" class="btn btn-default" ng-click="editableForm.$show()">Edit</button>
            <button type="button" class="btn" ng-click="deleteDeal()">Delete</button>
        </span>
        <!-- buttons to submit / cancel form -->
        <span ng-show="editableForm.$visible">
            <button type="submit" class="btn btn-primary" ng-disabled="editableForm.$waiting">Save</button>
            <button type="button" class="btn btn-default" ng-disabled="editableForm.$waiting" ng-click="editableForm.$cancel()">Cancel</button>
        </span>
    </div>
</form>
